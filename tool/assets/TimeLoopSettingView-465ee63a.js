import{C as Q,D as X,E as Y,G as C,H as Z,a as t,I as ee,J as oe,f as A,q as m,h as D,s as te,u as le,g as ae,r as d,o as y,c as S,w as a,B as h,K as ne,L,M as se,y as g,N as ue,_ as ie,v as N,F as P,O as re,x as U}from"./index-765ffbb1.js";import{u as I}from"./time-636e1097.js";function de(){const n=X({show:!1}),e=i=>{n.show=i},l=i=>{C(n,i,{transitionAppear:!0}),e(!0)},u=()=>e(!1);return Y({open:l,close:u,toggle:e}),{open:l,close:u,state:n,toggle:e}}function pe(n){const e=Q(n),l=document.createElement("div");return document.body.appendChild(l),{instance:e.mount(l),unmount(){e.unmount(),document.body.removeChild(l)}}}let B;const me={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let ce=C({},me);function ve(){({instance:B}=pe({setup(){const{state:e,toggle:l}=de();return()=>t(oe,ee(e,{"onUpdate:show":l}),null)}}))}function O(n){return Z?new Promise((e,l)=>{B||ve(),B.open(C({},ce,n,{callback:u=>{(u==="confirm"?e:l)(u)}}))}):Promise.resolve()}const _e=n=>O(C({showCancelButton:!0},n)),fe={style:{margin:"16px"}},ge=A({__name:"TimeLoopSettingViewItem",props:{data:{}},setup(n){const e=n,l=I(),u=m(""),i=m(5),v=m(20),_=m(2),r=m(""),T=m(""),V=c=>c&&/^[0-9]+$/.test(c)&&Number.isFinite(+c)?!0:"请输入正整数",q=()=>{l.updateLoopSets({id:e.data.id,title:u.value,loopTime:i.value,loopTimes:v.value,loopGapTime:_.value,src:r.value})},E=()=>{_e({message:"确认删除吗？"}).then(()=>{l.delLoopSets(e.data.id)}).catch(()=>{})},G=()=>{l.setSelectedLoopSets(e.data.id)||O({message:"请先提交！"})},f=m(!1),$=[{text:"long-1",value:"./audios/long-1.mp3"},{text:"long-2",value:"./audios/long-2.mp3"},{text:"long-3",value:"./audios/long-3.mp3"},{text:"long-4",value:"./audios/long-4.mp3"},{text:"long-5",value:"./audios/long-5.mp3"},{text:"short-dida",value:"./audios/short-dida.mp3"},{text:"short-dududu",value:"./audios/short-dududu.mp3"},{text:"short-jiazigu",value:"./audios/short-jiazigu.mp3"}],z=({selectedOptions:c})=>{var o,p;T.value=(((o=c[0])==null?void 0:o.text)||"")+"",r.value=(((p=c[0])==null?void 0:p.value)||"")+"",f.value=!1};D(()=>e.data,()=>{u.value=e.data.title,i.value=e.data.loopTime,v.value=e.data.loopTimes,_.value=e.data.loopGapTime},{immediate:!0});const{src:k,controls:b}=te(le()),F=()=>{k.value!==r.value?k.value=r.value:b.value.playing=!b.value.playing},j=ae(()=>(console.log("btnText"),k.value!==r.value?"播放":b.value.waiting?"加载中":b.value.playing?"暂停":"播放"));return(c,o)=>{const p=d("van-field"),w=d("van-button"),M=d("van-picker"),H=d("van-popup"),W=d("van-cell-group"),x=d("van-col"),J=d("van-row"),K=d("van-form"),R=d("van-collapse-item");return y(),S(R,{name:e.data.id},{title:a(()=>[h("div",{class:ne({selected:e.data.selected})},L(e.data.title),3)]),default:a(()=>[t(K,{onSubmit:q},{default:a(()=>[t(W,{inset:""},{default:a(()=>[t(p,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=s=>u.value=s),name:"title",label:"标题",placeholder:"标题",rules:[{required:!0,message:"标题"}]},null,8,["modelValue"]),t(p,{modelValue:i.value,"onUpdate:modelValue":o[1]||(o[1]=s=>i.value=s),name:"loopTime",label:"循环时间",placeholder:"循环时间",rules:[{required:!0,message:"循环时间"},{validator:V}]},null,8,["modelValue","rules"]),t(p,{modelValue:v.value,"onUpdate:modelValue":o[2]||(o[2]=s=>v.value=s),name:"loopTimes",label:"循环次数",placeholder:"循环次数",rules:[{required:!0,message:"循环次数"},{validator:V}]},null,8,["modelValue","rules"]),t(p,{modelValue:_.value,"onUpdate:modelValue":o[3]||(o[3]=s=>_.value=s),name:"loopGapTime",label:"循环间隙",placeholder:"循环间隙",rules:[{required:!0,message:"循环间隙"},{validator:V}]},null,8,["modelValue","rules"]),t(p,{modelValue:T.value,"onUpdate:modelValue":o[4]||(o[4]=s=>T.value=s),"is-link":"",readonly:"",label:"音频",placeholder:"音频",onClick:o[5]||(o[5]=s=>f.value=!0)},{button:a(()=>[r.value?(y(),S(w,{key:0,size:"small",type:"primary",onClick:se(F,["stop"])},{default:a(()=>[g(L(j.value),1)]),_:1},8,["onClick"])):ue("",!0)]),_:1},8,["modelValue"]),t(H,{show:f.value,"onUpdate:show":o[7]||(o[7]=s=>f.value=s),position:"bottom"},{default:a(()=>[t(M,{columns:$,onConfirm:z,onCancel:o[6]||(o[6]=s=>f.value=!1)})]),_:1},8,["show"])]),_:1}),h("div",fe,[t(J,{justify:"space-around"},{default:a(()=>[t(x,{span:"8"},{default:a(()=>[t(w,{round:"",block:"",type:"primary","native-type":"submit"},{default:a(()=>[g(" 提交 ")]),_:1})]),_:1}),t(x,{span:"8"},{default:a(()=>[t(w,{round:"",block:"",type:"success",onClick:G},{default:a(()=>[g(" 激活 ")]),_:1})]),_:1}),t(x,{span:"8"},{default:a(()=>[t(w,{round:"",block:"",type:"warning",onClick:E},{default:a(()=>[g(" 删除 ")]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1},8,["name"])}}});const ye=ie(ge,[["__scopeId","data-v-2f164515"]]),be={style:{margin:"16px"}},Te=A({__name:"TimeLoopSettingView",setup(n){const e=I();D(()=>e.loopSets,()=>{console.log("loopSets",e.loopSets)});const l=m("");return(u,i)=>{const v=d("van-collapse"),_=d("van-button");return y(),N(P,null,[t(v,{modelValue:l.value,"onUpdate:modelValue":i[0]||(i[0]=r=>l.value=r),contenteditable:"contenteditable",accordion:""},{default:a(()=>[(y(!0),N(P,null,re(U(e).loopSets,r=>(y(),S(ye,{key:r.id,data:r},null,8,["data"]))),128))]),_:1},8,["modelValue"]),h("div",be,[t(_,{round:"",block:"",type:"primary",onClick:U(e).addLoopSets},{default:a(()=>[g(" 新增 ")]),_:1},8,["onClick"])])],64)}}});export{Te as default};
