import{g as N,v as p,i as z,s as J,u as K,h as Q,r as s,o as g,b as x,w as l,y as S,D as W,z as h,a as o,E as X,A as f,G as Y,_ as Z,c as C,F as L,H as O,x as U}from"./index-ca29440d.js";import{u as A}from"./time-336663ad.js";import{s as ee,a as oe}from"./function-call-3c079a75.js";const ae={style:{margin:"16px"}},te=N({__name:"TimeLoopSettingViewItem",props:{data:{}},setup(w){const a=w,r=A(),c=p(""),i=p(5),m=p(20),v=p(2),t=p({path:"",name:""}),y=d=>d&&/^[0-9]+$/.test(d)&&Number.isFinite(+d)?!0:"请输入正整数",D=()=>{console.log("loopTimeAudio.value",{...t.value}),r.updateLoopSets({id:a.data.id,title:c.value,loopTime:i.value,loopTimes:m.value,loopGapTime:v.value,audio:t.value.path?{...t.value}:void 0})},G=()=>{ee({message:"确认删除吗？"}).then(()=>{r.delLoopSets(a.data.id)}).catch(()=>{})},$=()=>{r.setSelectedLoopSets(a.data.id)||oe({message:"请先提交！"})},_=p(!1),q=[{text:"long-1",value:"./audios/long-1.mp3"},{text:"long-2",value:"./audios/long-2.mp3"},{text:"long-3",value:"./audios/long-3.mp3"},{text:"long-4",value:"./audios/long-4.mp3"},{text:"long-5",value:"./audios/long-5.mp3"},{text:"short-dida",value:"./audios/short-dida.mp3"},{text:"short-dududu",value:"./audios/short-dududu.mp3"},{text:"short-jiazigu",value:"./audios/short-jiazigu.mp3"}],B=({selectedOptions:d})=>{var e,u;t.value.name=(((e=d[0])==null?void 0:e.text)||"")+"",t.value.path=(((u=d[0])==null?void 0:u.value)||"")+"",_.value=!1};z(()=>a.data,()=>{c.value=a.data.title,i.value=a.data.loopTime,m.value=a.data.loopTimes,v.value=a.data.loopGapTime,t.value=a.data.audio||{path:"",name:""}},{immediate:!0});const{src:T,controls:V}=J(K()),I=()=>{T.value!==t.value.path?T.value=t.value.path:V.value.playing=!V.value.playing},j=Q(()=>(console.log("btnText"),T.value!==t.value.path?"播放":V.value.waiting?"加载中":V.value.playing?"暂停":"播放"));return(d,e)=>{const u=s("van-field"),b=s("van-button"),F=s("van-picker"),P=s("van-popup"),E=s("van-cell-group"),k=s("van-col"),M=s("van-row"),H=s("van-form"),R=s("van-collapse-item");return g(),x(R,{name:a.data.id},{title:l(()=>[S("div",{class:W({selected:a.data.selected})},h(a.data.title),3)]),default:l(()=>[o(H,{onSubmit:D},{default:l(()=>[o(E,{inset:""},{default:l(()=>[o(u,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=n=>c.value=n),name:"title",label:"标题",placeholder:"标题",rules:[{required:!0,message:"标题"}]},null,8,["modelValue"]),o(u,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=n=>i.value=n),name:"loopTime",label:"循环时间",placeholder:"循环时间",rules:[{required:!0,message:"循环时间"},{validator:y}]},null,8,["modelValue","rules"]),o(u,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=n=>m.value=n),name:"loopTimes",label:"循环次数",placeholder:"循环次数",rules:[{required:!0,message:"循环次数"},{validator:y}]},null,8,["modelValue","rules"]),o(u,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=n=>v.value=n),name:"loopGapTime",label:"循环间隙",placeholder:"循环间隙",rules:[{required:!0,message:"循环间隙"},{validator:y}]},null,8,["modelValue","rules"]),o(u,{modelValue:t.value.name,"onUpdate:modelValue":e[4]||(e[4]=n=>t.value.name=n),"is-link":"",readonly:"",label:"音频",placeholder:"音频",onClick:e[5]||(e[5]=n=>_.value=!0)},{button:l(()=>[t.value.path?(g(),x(b,{key:0,size:"small",type:"primary",onClick:X(I,["stop"])},{default:l(()=>[f(h(j.value),1)]),_:1},8,["onClick"])):Y("",!0)]),_:1},8,["modelValue"]),o(P,{show:_.value,"onUpdate:show":e[7]||(e[7]=n=>_.value=n),position:"bottom"},{default:l(()=>[o(F,{columns:q,onConfirm:B,onCancel:e[6]||(e[6]=n=>_.value=!1)})]),_:1},8,["show"])]),_:1}),S("div",ae,[o(M,{justify:"space-around"},{default:l(()=>[o(k,{span:"8"},{default:l(()=>[o(b,{round:"",block:"",type:"primary","native-type":"submit"},{default:l(()=>[f(" 提交 ")]),_:1})]),_:1}),o(k,{span:"8"},{default:l(()=>[o(b,{round:"",block:"",type:"success",onClick:$},{default:l(()=>[f(" 激活 ")]),_:1})]),_:1}),o(k,{span:"8"},{default:l(()=>[o(b,{round:"",block:"",type:"warning",onClick:G},{default:l(()=>[f(" 删除 ")]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1},8,["name"])}}});const le=Z(te,[["__scopeId","data-v-1648326c"]]),ne={style:{margin:"16px"}},de=N({__name:"TimeLoopSettingView",setup(w){const a=A();z(()=>a.loopSets,()=>{console.log("loopSets",a.loopSets)});const r=p("");return(c,i)=>{const m=s("van-collapse"),v=s("van-button");return g(),C(L,null,[o(m,{modelValue:r.value,"onUpdate:modelValue":i[0]||(i[0]=t=>r.value=t),contenteditable:"contenteditable",accordion:""},{default:l(()=>[(g(!0),C(L,null,O(U(a).loopSets,t=>(g(),x(le,{key:t.id,data:t},null,8,["data"]))),128))]),_:1},8,["modelValue"]),S("div",ne,[o(v,{round:"",block:"",type:"primary",onClick:U(a).addLoopSets},{default:l(()=>[f(" 新增 ")]),_:1},8,["onClick"])])],64)}}});export{de as default};
